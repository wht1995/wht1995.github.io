<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>记一次性能优化 | VC&#39;s Blog</title>
    <meta name="description" content="记录一下叭🐌">
    
    
    <link rel="preload" href="/assets/css/0.styles.058b2d67.css" as="style"><link rel="preload" href="/assets/js/app.3d620a6f.js" as="script"><link rel="preload" href="/assets/js/5.e5a53480.js" as="script"><link rel="prefetch" href="/assets/js/10.0ab68627.js"><link rel="prefetch" href="/assets/js/11.79396d94.js"><link rel="prefetch" href="/assets/js/12.c84ca706.js"><link rel="prefetch" href="/assets/js/13.cc9287f8.js"><link rel="prefetch" href="/assets/js/14.69138d78.js"><link rel="prefetch" href="/assets/js/15.971bb51c.js"><link rel="prefetch" href="/assets/js/16.1e10d839.js"><link rel="prefetch" href="/assets/js/17.e96aff6e.js"><link rel="prefetch" href="/assets/js/18.5ee51ef9.js"><link rel="prefetch" href="/assets/js/19.dfabf67f.js"><link rel="prefetch" href="/assets/js/2.fe4a76b1.js"><link rel="prefetch" href="/assets/js/20.45e6fa32.js"><link rel="prefetch" href="/assets/js/21.9d90f167.js"><link rel="prefetch" href="/assets/js/22.bc222999.js"><link rel="prefetch" href="/assets/js/23.50e02b83.js"><link rel="prefetch" href="/assets/js/24.196726eb.js"><link rel="prefetch" href="/assets/js/25.35b23e5c.js"><link rel="prefetch" href="/assets/js/26.30b67b5e.js"><link rel="prefetch" href="/assets/js/27.dd5f26e2.js"><link rel="prefetch" href="/assets/js/28.5bb22549.js"><link rel="prefetch" href="/assets/js/29.cd1a78d5.js"><link rel="prefetch" href="/assets/js/3.b6b016ad.js"><link rel="prefetch" href="/assets/js/30.a08bb659.js"><link rel="prefetch" href="/assets/js/31.b6a25c09.js"><link rel="prefetch" href="/assets/js/4.975d3a1f.js"><link rel="prefetch" href="/assets/js/6.3c214a26.js"><link rel="prefetch" href="/assets/js/7.29aba97e.js"><link rel="prefetch" href="/assets/js/8.2c61a77c.js"><link rel="prefetch" href="/assets/js/9.c38e0b2c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.058b2d67.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">VC's Blog</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">notes</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">javaScript</a></li><li class="dropdown-item"><!----> <a href="/html/" class="nav-link">HTML/CSS</a></li><li class="dropdown-item"><!----> <a href="/http/" class="nav-link router-link-active">Http/浏览器/性能</a></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/nodejs/" class="nav-link">NodeJs</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/wht1995" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">Home</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">notes</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js/" class="nav-link">javaScript</a></li><li class="dropdown-item"><!----> <a href="/html/" class="nav-link">HTML/CSS</a></li><li class="dropdown-item"><!----> <a href="/http/" class="nav-link router-link-active">Http/浏览器/性能</a></li><li class="dropdown-item"><h4>后端</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/nodejs/" class="nav-link">NodeJs</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/about.html" class="nav-link">About</a></div><div class="nav-item"><a href="https://github.com/wht1995" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/http/" class="sidebar-link">这是HTTP的首页呀</a></li><li><a href="/http/tcp_3and4.html" class="sidebar-link">Tcp 三次握手四次挥手</a></li><li><a href="/http/浏览器缓存机制.html" class="sidebar-link">浏览器缓存机制</a></li><li><a href="/http/记一次性能优化.html" class="active sidebar-link">记一次性能优化</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/http/cookie.html" class="sidebar-link">前端存储</a></li><li><a href="/http/XSS.html" class="sidebar-link">XSS 攻击</a></li><li><a href="/http/CSRF.html" class="sidebar-link">CSRF 攻击</a></li><li><div class="sidebar-group collapsable"><p class="sidebar-heading"><span>http基础</span> <span class="arrow right"></span></p> <!----></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="记一次性能优化"><a href="#记一次性能优化" aria-hidden="true" class="header-anchor">#</a> 记一次性能优化</h1> <h3 id="前言"><a href="#前言" aria-hidden="true" class="header-anchor">#</a> 前言</h3> <blockquote><p>​	事情是这样的，公司的官网是运营领导找外包做的，做的 PC 端。然后做好了，拿回来说，现在浏览的用户大多是从手机移动端上访问的，所以叫我能不能适配一下移动端。好的吧，领导都说了，我能拒绝？我打开源码看，是 <code>PHP</code> 写的后台 + <code>Jquery</code> + <code>BootStrap</code>，一看这网站就是套模板的。虽然我不懂 <code>PHP</code> ，但是适配移动端还是能做到的。后来适配完后，领导又说，首次访问时候首屏打开太慢了，会白屏。好吧，那我再看看。...妈蛋，果然首次渲染要30s+ 甚至更久会到 1min+ ，你敢信？？</p> <p>​	然后，我就开始了我本次的优化之旅...</p></blockquote> <h3 id="第一步"><a href="#第一步" aria-hidden="true" class="header-anchor">#</a> 第一步</h3> <blockquote><p>​	之前只是听说过性能优化这回事，但是自己并没有亲手优化过什么，所以网上说的什么优化手段，只是看过而已，并没有什么切身的感受。这次趁这个机会了解并实践一下。</p></blockquote> <p>​		那么问题来了，首屏渲染慢，出现白屏，会是什么原因导致的？我第一反应就是，网络问题吧，是不是网络太慢了，导致资源加载过慢，所以东西出来的时间要花很久。于是，我按下了神奇的 <code>F12</code> ，开发者开发工具顿时映入眼帘😄</p> <p>​		切换到了 Network 面板，大致扫了一眼，发现，网站的内容很大一部分都是由图片构成的，120+ 的请求，有 80 个请求都是关于图片的，3.2MB 的资源，图片占了2.4 MB，图片占了大头啊！！</p> <p><img src="/assets/img/1566789797236.4d7940b1.png" alt="1566789797236"></p> <p>​		现在看到的其实是我优化过后的面板信息，之前的 waterfall 可以拉很长很长，然后 Time 会持续到 30 几秒甚至 1min 。</p> <p>​		没优化之前，首页轮播图的 3 张图片，每张平均有 600kb+ ，仅仅是轮播图而已噢！！就差不多 1.8Mb 了，就是现在优化后的所有图片总大小的 1/2 还多。这哪行？？😭</p> <p>​		那怎么搞？？只能压缩了呗，反正我第一个想到的是这个。（当然还有雪碧图，可以减少请求的次数，也是优化的一种常见手段噢）</p> <p>​		这里推荐压缩的软件：</p> <ul><li><a href="https://zhitu.isux.us/" target="_blank" rel="noopener noreferrer">智图<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://tinypng.com/" target="_blank" rel="noopener noreferrer">TinyPNG<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li><a href="https://squoosh.app/" target="_blank" rel="noopener noreferrer">Squoosh<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="第二步"><a href="#第二步" aria-hidden="true" class="header-anchor">#</a> 第二步</h3> <p>​		好了，图片压缩完了，图片加载的时间也缩短了，可是，清除缓存后再刷新，还是会出现白屏啊？咋回事啊？一看面板的 waterfall 瀑布流，发现首页的文件迟迟加载不完，可是不应该啊，才 59Kb 的文件，没道理下载那么久的，是不是有什么东西阻塞了？</p> <blockquote><p>​	阻塞？？是哦，JS 加载和 DOM 的解析是互斥的，即加载 JS 的时候会停止DOM 渲染，如果解析 DOM 的时候遇到了 JS 脚本，会暂停解析，直到 JS 加载执行完才继续解析 DOM。</p></blockquote> <p>​		后来去看 JS 面板，发现，果然！Jquery 这个文件下载了 30s + ，原来症结在这里...</p> <p>​		那应该如何去看面板上的信息？这也是今天主要的学习记录。</p> <p><img src="/assets/img/1566804495486.f63ac017.png" alt="1566804495486"></p> <p>​</p> <p>​		接下来看看图中的各项指标各自的含义是什么：</p> <ul><li><p><code>Queuing</code></p> <p>请求排队的时间。需要了解一点，就是浏览器与同一个域名建立的 TCP 连接数是有限制的，chrome 设置的 6 个，如果说同一时间，发起的同一域名的请求超过了 6 个，这时候就需要排队了，也就是这个<code>Queueing</code> 时间。</p></li> <li><p><code>Stalled</code></p> <p>是浏览器得到要发出这个请求的指令，到请求可以发出的等待时间，一般是代理协商、以及等待可复用的 TCP连接释放的时间，不包括 DNS 查询、建立 TCP 连接等时间等。</p></li> <li><p><code>DNS Lookup</code></p> <p>DNS 查询的时间，页面内任何新的域名都需要走一遍 完整的 DNS 查询过程，已经查询过的则走缓存。</p></li> <li><p><code>Initial Connection / Connecting</code></p> <p>建立 TCP 连接的时间，包括 TCP 的三次握手和 SSL 的认证。</p></li> <li><p><code>SSL</code></p> <p>完成 ssl 认证的时间。</p></li> <li><p><code>Request sent/sending</code></p> <p>请求第一个字节发出前到最后一个字节发出后的时间，也就是上传时间。</p></li> <li><p><code>Waiting/(TTFB)</code></p> <p>请求发出后，到收到响应的第一个字节所花费的时间 (Time To First Byte)。</p></li> <li><p><code>Content Download</code></p> <p>收到响应的第一个字节，到接受完最后一个字节的时间，就是下载时间。</p> <p>分析一下，阻塞页面的解析是因为 JS 资源的下载过慢导致的，但资源也是压缩过了的，该如何解决？</p> <p>既然从本地服务器上加载慢，那么我就换 <code>CDN</code> 的资源😄</p> <blockquote><p>​	CDN 的基本原理是广泛采用各种缓存服务器，将这些缓存服务器分布到用户访问相对集中的地区或网络中，在用户访问网站时，利用全局负载技术将用户的访问指向距离最近的工作正常的缓存服务器上，由缓存服务器直接响应用户请求。</p> <p>​	其目的是使用户可就近取得所需内容，解决 Internet 网络拥挤的状况，提高用户访问网站的响应速度。</p> <p>​																																				——摘自百度</p></blockquote> <p>经过前两步问题的排除与解决，“白屏”的问题得到了很大的改善。</p></li></ul> <p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqkAAAAeCAYAAAAPdocjAAAVpklEQVR4nO2df2xTR7bHv/c6Kd1m+bFOIDQFsiqEQPO6odRCawqiQtuoioqREGg32q1Wr7a0lmhU/klFum+tt+5TiV7+4SlBykpOpVWpvKsipLjdPJSsKlBCbkX92qS7BoKBNiSlBIILoWmbEtvvD2fGM/eHf+RH8arnIyHF986de+bMOXfOPXNslGQymQRBEAXLtWvXsG7dugctRkFCurGGdJMd0tHcId2ZMzQ0hJUrV6KiouJBi5IX//XedQDAf7xQWHIr4XCYglSCIAiCIAiioFBisRgFqQRBEARBEERBoT5oAQiCIAiCIAhCDwWpBEEQBEEQRMFBQSpBEARBEARRcFCQShAEQRAEQRQcFKQSBEEQBEEQBQcFqQRBEARBEETBQUEqQRAEQRAEUXBQkEoQBEEQBEEUHBmDVIfDAU3T+OdYLAaHw8H/RaNR03Nut3vxJC4U7nyKT+9kbhKNRiV9xWIxQ5tMOhUJBAKWeg2FQnA4HPyz2+2W+iwEAoEAHA4HQqHQ93Y/0XbN+O76p7j+XeZ+mG4z2bWmaZK+A4GAaTu32215zu/3w+/3AzDaBDv+gyQHP9Prn82T2+3Oam9M11Z+ByBvH9LPXza/NfOLhfXf73D9ynVkMXXsPjqKiuYr/N/uo6M5tRufnOHnTp2fMhxjDI5No6L5CgbHpqXjYl/+7tt5j26xGZ+csdTFfDl1firvMecjD9O52XyIdA7chef4DemYOC8LQS7P23/86pe4PzGxIPebT9/jJ97B5deaM7aZGr6Isxs3SMdGj7Xj7MYNOLtxA+709c1ZViKNaZDKAgqXyyUd7+/vRzgcRjgcRjAYREtLCz/X1NSEYDCIcDgMp9P5vQUj8yEUCs1dzs+60PVZ9mZMXz6fD+3t7YbzmXSqZ2hoyDTw6urqMhzr6elBOBxGW1ubZZAzr/HnQSwWg6ZpCIfDBpt6kNwLd+HDLAHQ5s2b+fxUVlZa6svr9fJ2Ho/Hsr+Ojg7Dy0osFjP0W1tby/urqKj4l/CnRSFHPxP139nZCQDo7OzMam92ux3hcBhVVVULIS1HnD8mj4imaejq6uJt/H4/D5Tdbjfa2tr4c2P+Lyn38OHfPsS9HFp+3FyJ60fW4/qR9fj1tmWGAKei+QperbPzNt0H1+CpIyOGIOhP/XcNfYc++Ur6PD45g4rmK+g+uIb399iKoqwBVSYGx6YNwdaD6KMQ2H10FO2nv8yp7R/elYO33UdH8eaLq3H9yHq8vqdsQfSRy/O2UMgWoALAF3/+s/T5Tl8fpj//HM9cuoxtAx8g4v73xRLvB4VpkOrxeBAOhw3HxQd+VVUVhoaGAKQyhpWVlfxBv2vXLtPA6YeGuPBt3rzZtI2VTs3wer3o7e2VjkWjUTidTstrysrKchV30bh9+zYqKysftBhzQpzDLVu2mLa5desWVq1alVN/Xq8X/f390rH+/n54vV7La3LtmygMcrH3SCQivcz4fD5cuHCBv8Awn3a5XA/sBcW9fTle31PGA05/9228vqcMzz9RwttsWbMEb764WgpKvTtXoKPPGI2cvvQ16mvS1/4+NIHug2uwZc0S6Z7ly4oWYzg/ON4/tBaB36zO2o7NK4O9JLB5dm9fju7I1OIIWYCMHmvHhjeOZGxzp68PS7dulY5N/G83Hv3tbwEAxWVlKN9/gLKpC8Cca1JjsRhqa2sBABcuXJAWcKtgKxqN8m1NtgUmbnmJGQN9+YC4fet2u6VslPhZv8XOEO8TCAQQCoW4LGwrXrx2oUsWzpw5YxnkiGNmOjWjpqYGIyMj0tiDwSB27dqV8b7PPfec4bjZ+P1+P9eTpmmGbVSW6WEZWFZWIOpKr8NoNIqGhgbeL+sjU79sjvKxF7HPxSo36erqsnzZYHrMtj1r9gLn9/szzmFXVxd27Nhheo5tFYvlJGa6tbJtUW7xuL5cQvystxN2Xl/ukKsvLhZidtLv90v2LN5XlM2qPEe8lo05FApZyi+OMVMpAWPlypW4efOm6bna2lrTUiFx7rKVtsyVp9c9jGux+wBSQeYL/1ZiaPPUmiU4felr6Zh35wqcOp8ObDoH7uLX25bxz+OTM7g6cV8KUPV0Dtw1LStgmU5/923p3ODYNOqPjaE7kio5YPf3HL/B23UO3J1TH1ZYlSqI/eq3y0V5Pr8zY3mOyarXxXv/lPU6nxIJVnrx9LqHM7bbVP6QaYZblDebrubD+Il3+Db62Y0b+Lb9/YkJ6fj4iXf4NWw7/uzGDRg91i4d/8evfml6n6nhiwCAHz/5ZEZ5Ro+1o3z/AYOMJdWb+OelW7dietyYgRbHIspFmDPnV9ampiYcPnw47+tCoRCCwSCqqqqgaRpu3rzJs7ahUAiapsHpdKKpqQltbW1wOp2IxWKoq6tDW1tbxr5jsRhaWlp4f9FoFIFAAPv27eNba2awbGZTUxN6enpgt9vzHpcVbrcbQ0NDfCyZyEWne/fuRX9/P1wuF1+4zLYq6+rqAKQWOLPtZzGDK/49ODgo6UnUZTAYhM/nA5BaIJmuWADgdDrR0tJi0GEwGJSudbvdUhu32823RP1+v3TPXO2FbZHmYy+5wPoCYGkbLpeL6zAQCMDv9/Ox6iktLUVlZSWi0Sgfk1nboaEhHjx5vd6sNsl0YqVbs3kJBAKoqKiQ9JlJdhHRTligJtrNXH1xrnR0dKCjowNASl9mNh8IBPh9HQ4H9u3bZ9CHlZ9GIhGEw2FEo1G0tLRk9OWqqip+H03T0NDQYBhvTU0NAoEA74f9zeRhdq1pmukLv6Zp0twtFo8us+HqxH3+2SzLWb6sCBfH5WJD189+jPbTX/Js3NvnJvH+obXQrn7D2zxeVmx531Pnp/D2uUlcP7IeQCqYeurICP/cHZnCmy+uhq9+PToH7uJP/Xfhqy9F98E1aD/9Jc8g+rtvY//Wpfyz5/gNHmjn2odV+QHbEmdj9By/gc6Bu3BvXw5ffSl89aUAUoEkO+7vvo119mI+jt1HR/Hsxkcyyvrx2LSki4Ws260/NobrR9ZLdcJsjk+dn8LzT5Tg1Pkpw/yy8+JYFos7fX24eeIEnrl0GUAqkDy3/ed45tJlFJeV8eMAcHbjBpTvP4D7ExMY3PMCtg18gOKyMtzp68O1/zma9V6De17AM5cu82DVjMuvNePxP/5xTmO5PzEhjYXITt6ZVJbhbG1tnVMdl8vl4tdFIhF0dHRImbFIJGLY8rLb7Rm3QxnDw8N8cXc4HGhoaICmafzBn622y+l08oBkoejs7EQ4HEYkErHM8OWjU5fLxcdx8uRJ0ywpkK5JbW1tzevLFw0NDdJnli3VH/f5fFyvW7Zswa1btwBk12EsFsPQ0BDq6ur4PA0NDfE51wdIi2kvucBqFsPhMJqamrJm/jweT9bt2YaGBgSDQQCp4MQsSyrWNNbU1GS0XRYgZ9Kt2bxomoZ9+/ZJ/eS6tSzag74fYP6+mC+51ASLL4Aulwu3b8uLfU1NDRobG00zn6xPcZfI5XJlrD8GUjbpcrkMfTqdTjidTq4fMehtbW1FY2MjHA4Hent7TXdXqqur0dHRseilAF9MxqVg0ixgG5+cwabyh6RjLEM6ODaNU+eneCAmIga/es599i1erUu/QGxZswT1NSU8mKqvKeHBoZjt1XP60td46a10tq87MoWP8+zDDP2WOAC8/OxPeBDO6m0rmq9I9Z6nL32N3+1Yzj+LY7SSVa8L8XoWEM8Fz/Eb6D64xvRc8KVHuSwnPrpnmF8glUHv6LsjZXwXg3ufDGHtwZf555LqTSjff4AHkuKXlRhTFy5g3SuHUDxb7rZi504s2/o0v/7Jv/zVcJ/LrzVjy7vvZZRl/MQ7WLp1q5QxzQcmTy41r0SKvDKpLIugf3tfuXIlent7+WIZjUZz/oKMWeYiFovNuYbRKovS2dnJtx+t2ng8Hng8HjgcDtTW1pp+4WGueDweaJqGWCwmZW+sdJoJr9cLTdPQ0dGR9Tq73c63C/PNELvdbhw+fBhVVVU8k5qNXHQ4H90utL3kQ2trK5qamrIGJtmoqqrCyMgINE1DZWUl7Ha7IWASqa6uznlb3Eq3udp2pnKTfJmPLz4InE4n/xJTKBRa8F0VPWxOgNTLSk1NDYD0ixGQsu2mpiaDHKwNKyvIZadmLoQ++QrOx38EAHh24yN4759TcG9fLrX5eGzaNAjdv3UpQp98hWux+3j52Z9I51i2bnBsOuOWv55Hl9nwxWQ8rzF83FxpyADrf2FgoVhnL8b45IyU9dUHcZlqbs1kPffZt1i9wHW6g2PT6I5MGWpNdx8dxfuH1qJ8WRGXf3xyBg1vfmGQi7VhpQhiVvn74KHSMowea8dD5eU8MykGqg+Vl+fc19TwRYyfeEcqFwCAb65elQJaFlyKQebZjRuwbeADLNv6NKaGL/IA9t5HH/EaVZEn//JXXoqw7pVDUgBOGMkrkxoMBtHa2mo4zr7NzzJaVnWQetiWlx673Y5QKMSzD7FYjG/lAUBlZSWGh4cBpII8ltlg2QWz+i0gFRz09PTw+i2rOjBxgZgPYp0YG4vdbkc0GuVZVSudZmLXrl1obGzMaVuWZdfMFttMdXCM0tLUW/qZM2fyktFKh+J2Zr7M1V7mgyhnf38/DwSs6hEDgUBOWdy9e/eisbHRkKE2Y3h4OKcgPBfdivPidDpx8uRJfi4UCvHxrVq1CpFIhJ/LpE99P0D+vlhI+Hw+eL1e/oyxIlNNKkPTNIyMjPAXPbPdlGg0yrf39bS3t2cM4l0uF9ra2qS5Wij83bdx+tLXPCj93Y7l+MO7E1Lt4eDYNF5664aU3WM8/0QJ/wKVWSD6ap0d9cfGpOxs58BdjE/OYNtPH8Z/96RtZ3BsGlcn7mf9UpW+POHZjY+Y/tJAPn2YIW6JM9pPf4ltP03VdoqZx7fPTfK/Hy8rloJWcYxWsj62okj6lr7YZi41qRXNV/DoMhv/RQX2Kw31NSV4/9BaQ/vfhyakTK4e9/blePPF1Tj32bd5yZErS39Wa6gp/ebqVZ6VXFKeKo8Qv6RUvGqlFEje6evD5Ef/x6/X16SWVG/CM5cu839b3n0P5fsP8ACV1cGKbVhgzMoOVu3fj9jf/w4gta3/zdWrlhnXkupN2DbwAX2xKgfyej0bGRkxbBmyN/hgMMjPeb3enN7qnU4nIpGItB3N6g+DwSBfwGtra6WFv6GhgZ9zuVw8+2O329HW1ibJ6PP5sGPHDukYywhWV1ejsbERHR0d6OnpQVNTEw94xe3sudLb24vGxkb+2SzrmUmnVlRVVcHlcll+mQaA1GdPT49pG/349ezdu1ea01xgNbhAWof6LGFra6skn8vlyingnqu9zAdx/qzkZJm3TG30uFwudHV1WZZ3iDWp+WSerXRrNi8ej4d/+UYvu8vlgsPhkOo8rdD3w7Kj+fhiIRAIBPh4c9nKt4LV9jLM/J59odCsjWhPPp/P9FmgaVrWZ8tceOrICP/bu3OFFLSwzJn+i0CZahJf31OGx1aYLzPPP1HCf8JKbF++rAjPP1GEz+/MSPfKpfaRBY8ss+erL8Xuo6PSrw1k60ffx1NrluDi+HeSLN0H1+D9Q2ulY+IvHzxeVszPeXeu4G0Cv1ktlQC8vqeMf3nKSlb39uXQrn7D+xO/ib9YeI7f4FlW/S86ME6dn8JLb6W/GLRQtanntv+c/73hjSMo338A0+M3pCwpCxDtv/gFBve8AABY98ohfr6kehM2vHGEX7PulUN8u3+xKN9/AJdfa+b33DbwgaHN/YkJaXzZygsIQInFYskHLUQusO2wxdjSIgiCIAiCIAoL+m9RCYIgCIIgiIKDglSCIAiCIAii4PiX2e4nCIIgCIIgfjhQJpUgCIIgCIIoOChIJQiCIAiCIAoOClIJgiAIgiCIgoOCVIIgCIIgCKLgUErtpUlVTceqiqIgmUxCURQA4H8rqoJEIsGPM9gxdl0inoCtyAZFmW0/2yc/n0hAVVUk4gkoqiLdL5lMps4lElwWsV/Wnp1LJBJIJpJQbWr6fjq52XWsXTKZ+p5YMpHk/YnXsvPiOPXjVlWV9x+PxyXZVVVFPD7D28XjcdhsNj4m8ZgoJ7sPQzyuH5s0gbPn9Pqy2Wxc32ZjFHUtyqcfv3it/njq2iLE43FJL6wPvZx8bBDHphrkZLoompVLtA8uk6oa7sM+p+SYnatZ22VypfpXDNemdJGyCUnn6RGk50VoAyhcViZ3ylfS/SuKwuddURSDzYq6SySSsAn+yHSlKAoUGO2AjUlVFEABVFWeS+Z/og7Z1aqqYmZmBqqqgnWZaiPMVzIp2YBq4v+qzr+LbDaDzah6/xevQ1o2m87/xevSemDzk7ZjvXxsnkSbtwk2kxTGJV6bOq9IOmZzKuots/+n/MHGfL2o6Hv1/0QO/p/I4P9JZPb/JET/t/HxKhb+L/Ynjo0d18uZnNWFzcT/k5Cfc4Im+HlVmGexbTJl2FwGEaYLcdxxYT5k2VXeBgDis7KyORT1xdrxdYHZGrPZuN7/U+cYCcFOxf6ZZpMJ+by4fiYEHaR1mOCTIvq/OE/JpHEd5WupZIO6eZuV3yb5v3C9zv/5dYm0bJbrv2594Os/8zvFYv0XbF60C+m5qmvHni98DiSdKzyO0Pu/Tef/5uu/bfaZkPZ/9szK6v9qar0RZyDn9V81rv827v9Fkv+Ltp19/bflv/7rxpZMJhFPJKAo6XaJeNr/bY/86JH/ZDcwfZDM3jCRSABJOcDQG6g46UkT51JVld9YvJ9oRAzDg3M2gGBt+LWqbJSiYmdtanZAqb/ZcZvNxgNYEVEu8QGp71c0ANZf+lhah2zhEhdHcTJFHYtj4w+2mZSR618kxLaiUSiKwg1HPB6fiUtBvkGPunHo+xdtI22gRQajFh2NPbjFa1RVBRS5naKoRrvRjU2cF9VmPnb2cOTtITux6JD8wax7mDF4v8J8pR+2CRQVsbELi55OVv3CoSjKbKCUdmgxWCkqKk6NS7ABZp/6PkVfE3XBFhgevOrmMZFI8CBYfKDk5P+z+tD7v6osjP/bTPxfEeTUj0cMJvV2Iy+mkPQq9a9rp6o2SWbxpURVcvX/dIA/b/+P5+//qpn/zy6mufg/C2DF/iU9CQuU6P8suBTnEIAU1LJ+9UGcaDdQZLtg8prJnh5jEjZbEb9WbCP6vyrYH5sPM/9PmMyXuGAXFRVL+jXzJaP/g78oSf6fZP6f/p+59P5t6f+qAiRF/58dTwb/V1WV31OyPT5+o22yYFr/UpV9/U/1GJ997pj6P9j6n14vDOu/qf8L644Q7Fn5v9jeyv9tuaz/s3FQNv/PuP4nktLLOZ8DZPD/WVHVLP5vuv7Hjet/+nmYNIwjt/Vf9n+mM3EO9ddk8n/o7sXu/f8hc/ZGkur91AAAAABJRU5ErkJggg==" alt="1566887635799"></p> <p>​</p> <p>​		从之前的 30s+ 到现在的 <code>DOMContentLoaded</code> 1.49s，可以说是秒开了😂。</p> <p>​		这里简单说一下 <code>DOMContentLoaded &amp; Load</code> 事件。</p> <ul><li><p>DOMContentLoaded</p> <p><code>DOMContentLoaded</code> 事件在解析加载完纯 HTML 的时候触发，而不必等待样式表，图片或者子框架完成加载。<code>DOMContentLoaded</code> 所花的时间，基本上就是白屏的时间，所以我们要缩短<code>DOMContentLoaded</code>触发的时间。这里来明确 一下<code>DOMContentLoaded</code> 所计算的时间：</p> <blockquote><p>当文档中没有脚本时，浏览器解析完文档就能触发 <code>DOMContentLoaded</code> 事件；如果文档中包含脚本，则脚本会阻塞文档的解析，而脚本又需要等待位于脚本前面的 CSS 加载完才能执行。</p></blockquote></li> <li><p>Load</p> <p><code>Load</code> 事件在页面资源（图片、音频、视频等）加载完后触发。一般 <code>Load</code> 在 <code>DOMContentLoaded</code> 之后触发，<code>DOMContentLoaded</code> 的触发不需要等待图片等资源加载完成</p></li></ul> <h3 id="总结"><a href="#总结" aria-hidden="true" class="header-anchor">#</a> 总结</h3> <p>​		影响首屏展示，阻塞页面渲染的原因有很多种，本次对公司官网进行优化主要是涉及对图片和资源请求的优化。</p> <h4 id="图片优化"><a href="#图片优化" aria-hidden="true" class="header-anchor">#</a> 图片优化</h4> <ul><li>视情况转换适当的图片格式，例如 <code>.png</code> 、<code>.gif</code> 转成体积较小的<code>.jpeg</code></li> <li>使用最新的 <code>.webp</code> 图片格式，但是兼容性还不是很好</li> <li>集中的小图片使用雪碧图，以此减少对服务器请求的次数</li></ul> <h4 id="请求资源优化"><a href="#请求资源优化" aria-hidden="true" class="header-anchor">#</a> 请求资源优化</h4> <ul><li>把 CSS 放在顶部加载，JS 放在底部加载</li> <li>静态资源尽量使用 CDN</li></ul> <h4 id="影响页面加载的因素"><a href="#影响页面加载的因素" aria-hidden="true" class="header-anchor">#</a> 影响页面加载的因素</h4> <ul><li><p>js 性能太差，阻塞页面</p> <blockquote><p>因为浏览器解析过程中，遇到 <code>&lt;script&gt;</code> 标签的时候，便会停止解析过程，转而去处理脚本，如果脚本是内联的，浏览器会先去执行这段内联的脚本，如果是外链的，那么先会去加载脚本，然后执行。在处理完脚本之后，浏览器便继续解析HTML文档。</p></blockquote></li> <li><p>某个请求阻塞页面加载</p></li> <li><p>同域名下的请求次数过多导致 Queueing 过久</p></li></ul></div> <div class="page-edit"><!----> <!----></div> <!----> </div> <!----></div></div>
    <script src="/assets/js/app.3d620a6f.js" defer></script><script src="/assets/js/5.e5a53480.js" defer></script>
  </body>
</html>
